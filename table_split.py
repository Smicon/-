import pymysql
import json
from image_match.goldberg import ImageSignature
import hashlib
import time
from tkinter import _flatten
from collections import Counter

def mysql_config():
    print('连接mysql...',  )
    db = pymysql.connect(host='localhost', port=3306, user='wwj',passwd='Shalou-2018', db='vvic', charset='utf8')
    cursor = db.cursor()
    # 开始程序先配置，使能用group by
    cursor.execute("set global sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';")
    db.commit()
    cursor.execute("set session sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';")
    db.commit()
    print('连接成功')
    return db,cursor

def mysql_insert(table, field, value):
    cursor.execute("insert into {}({}) values ({})".format(table, field,value))
    db.commit()

def mysql_update(table, field_value, where):
    cursor.execute("update {} set {} where {}".format(table,field_value,where))
    db.commit()

def data_split():
    cursor.execute("select  product_id, shop_id, images, images_url from tb_product_detail where hashcode is null")
    product_select = cursor.fetchall()

    table_num = 10
    total_num = len(product_select)
    num_per_table = int(total_num/table_num)+1
    table_infos = []
    table_cnt = 0
    while table_cnt< total_num:
        table_infos.append(product_select[table_cnt:table_cnt+num_per_table])
        table_cnt += num_per_table

    for t in range(table_num):
        table_name = 'tb_product_detail{}'.format(t)
        table_info = table_infos[t]
        for row in table_info:
            mysql_insert(table_name, 'product_id, shop_id, images, images_url', str(row))
        print('{} ok'.format(t))

def data_merge():
    table_num = 10
    def select_per_table(table_name):
        cursor.execute("select  product_id, hashcode from {} where hashcode is not null  and product_id  in (select  product_id from tb_product_detail where hashcode is  null)  ".format(table_name))
        product_select = cursor.fetchall()
        product_ids = [str(x[0]) for x in product_select]
        hashcodes = [x[1] for x in product_select]
        return product_ids, hashcodes

    def insert2tb_matching(product_id, feature_list):
        print('insert to tb_matching...', end='' )
        for x in feature_list:
            mysql_insert('tb_matching', 'product_id, hashcode', "{},'{}'".format(product_id, x))
        print(' done...',  )

    def insert2tb_product_detail(product_id, hashcode):
        table_name = 'tb_product_detail'
        print('update to {} ...'.format(table_name), end='' )
        mysql_update(table_name, "hashcode='{}'".format(hashcode), 'product_id={}'.format(product_id))
        print('done...',  )

    for table_id in range(table_num):
        table_name = 'tb_product_detail{}'.format(table_id)
        product_ids, hashcodes = select_per_table(table_name)
        cnt = 0
        num = len(product_ids)
        for product_id, hashcode in zip(product_ids, hashcodes):
            feature_list = json.loads(hashcode)
            # insert2tb_matching(product_id, feature_list)
            insert2tb_product_detail(product_id, hashcode)
            cnt  += 1
            print('[{}/{}] {}'.format(cnt,num,table_name))

def fill_shop_id():
    cursor.execute("select distinct product_id  from tb_matching where shop_id is null")
    product_select = cursor.fetchall()
    product_ids = [str(x[0]) for x in product_select]
    product_num = len(product_ids)
    for i, product_id in enumerate(product_ids):
        cursor.execute("select shop_id  from tb_product_detail where product_id ={}".format(product_id))
        product_select = cursor.fetchall()
        shop_ids = [str(x[0]) for x in product_select]
        shop_id = list(set(shop_ids))[0]
        mysql_update('tb_matching', "shop_id='{}'".format(shop_id), 'product_id={}'.format(product_id))
        print('[{}/{}] ok'.format(i+1,product_num))
        stop = 0

def show_pic_link():
    product_ids = [577692000305,578191881353,578483657631,578677944652,578685252450,578687528582,578694732869,578701700138,578711868562,578839220054,578839332873,578841944462,578844188644,578845872826,578852456665,578854044763,578858704746,578864384899,578864404812,578871157099,578878057304,578882361059,578897537047,578908656165,578917632308,578924864350,578925904502,578930968926,578962313677,578964000190,578964844758,578986812746,578987764472,578987772099,578990680955,578991852646,578998934664,579003068170,579006508759,579009502144,579010232424,579011121818,579012089936,579012594962,579015793796,579016321903,579017682463,579020034338,579020945345,579026477272,579038105094,579040288537,579042944439,579043365863,579044453895,579045357367,579057188432,579059280146,579062600070,579073560581,579079084357,579079728725,579080084495,579080264865,579084680222,579098177648,579108665184,579113085387,579113477027,579113848321,579114913040,579121024934,579123399154,579124542365,579130499434,579135110276,579135502744,579136318705,579137402720,579142042161,579142413790,579146182250,579146438526,579146726978,579157958231,579162950328,579164486610,579164957525,579166333233,579167425040,579170054870,579174325276,579174420029,579182668407,579187540993,579191149073,579191713613,579197252214,579198116008,579199427996,579200876144,579210544302,579220073061,579220222669,579231438188,579232926829,579234814080,579239574605,579240145913,579243065356,579243221071,579243607519,579244499968,579244637472,579245609821,579246544998,579246953709,579247559069,579248267801,579248515279,579255815473,579258751145,579259116925,579262399043,579264911960,579270867502,579283639645,579283703168,579284534999,579287187271,579290719064,579293798898,579294854085,579296306512,579303749600,579313725833,579317386009,579317674187,579318525853,579319711576,579333265468,579345278635,579357809313,579361946277,579363703276,579366958175,579369118242,579374334530,579375238521,579378637587,579382726785,579383352473,579392979839,579407901663,579408967399,579411795959,579417531914]
    # product_ids = product_ids[:3]
    gis = ImageSignature()
    feature_all_id = []

    for i, product_id in enumerate(product_ids):
        cursor.execute("select images_url  from tb_product_detail where product_id ={}".format(product_id))
        product_select = cursor.fetchall()
        urls = json.loads(product_select[0][0])
        t1 = time.time()
        with open('img_md/{}.md'.format(product_id),'w') as f:
            feature_per_id = []
            for url in urls:
                try:
                    feature = gis.generate_signature(url).tolist()
                    feature_str = json.dumps(feature)
                    feature_md5 = hashlib.new('md5', feature_str.encode('utf-8')).hexdigest()
                except:
                    feature_md5 = '转换不出特征码'
                line = feature_md5+'<img  src="{}">\n'.format(url)
                f.write(line)
                feature_per_id.append(feature_md5)
        feature_all_id.append(feature_per_id)
        t2 = time.time()
        print('[{}/{}] {} {}'.format(i+1,len(product_ids),len(feature_per_id),t2-t1))
    inner_features = set(feature_all_id[0]).intersection(*feature_all_id[1:])
    with open('img_md/inner.md'.format(product_id), 'w') as f:
        indexes = [feature_per_id.index(x) for x in inner_features]
        inner_urls = [urls[x] for x in indexes]
        for url in inner_urls:
            line = '<img  src="{}">\n'.format(url)
            f.write(line)

def val_matching():
    product_ids = [577692000305,578191881353,578483657631,578677944652,578685252450,578687528582,578694732869,578701700138,578711868562,578839220054,578839332873,578841944462,578844188644,578845872826,578852456665,578854044763,578858704746,578864384899,578864404812,578871157099,578878057304,578882361059,578897537047,578908656165,578917632308,578924864350,578925904502,578930968926,578962313677,578964000190,578964844758,578986812746,578987764472,578987772099,578990680955,578991852646,578998934664,579003068170,579006508759,579009502144,579010232424,579011121818,579012089936,579012594962,579015793796,579016321903,579017682463,579020034338,579020945345,579026477272,579038105094,579040288537,579042944439,579043365863,579044453895,579045357367,579057188432,579059280146,579062600070,579073560581,579079084357,579079728725,579080084495,579080264865,579084680222,579098177648,579108665184,579113085387,579113477027,579113848321,579114913040,579121024934,579123399154,579124542365,579130499434,579135110276,579135502744,579136318705,579137402720,579142042161,579142413790,579146182250,579146438526,579146726978,579157958231,579162950328,579164486610,579164957525,579166333233,579167425040,579170054870,579174325276,579174420029,579182668407,579187540993,579191149073,579191713613,579197252214,579198116008,579199427996,579200876144,579210544302,579220073061,579220222669,579231438188,579232926829,579234814080,579239574605,579240145913,579243065356,579243221071,579243607519,579244499968,579244637472,579245609821,579246544998,579246953709,579247559069,579248267801,579248515279,579255815473,579258751145,579259116925,579262399043,579264911960,579270867502,579283639645,579283703168,579284534999,579287187271,579290719064,579293798898,579294854085,579296306512,579303749600,579313725833,579317386009,579317674187,579318525853,579319711576,579333265468,579345278635,579357809313,579361946277,579363703276,579366958175,579369118242,579374334530,579375238521,579378637587,579382726785,579383352473,579392979839,579407901663,579408967399,579411795959,579417531914]

    # feature_all_id = []
    # for product_id in product_ids:
    #     cursor.execute("select hashcode  from tb_matching where product_id ={}".format(product_id))
    #     product_select = cursor.fetchall()
    #     feature_all_id.append([x[0] for x in product_select])
    # inner_features = set(feature_all_id[0]).intersection(*feature_all_id[1:])
    # print(len(inner_features))

    sql = ' or '.join(['product_id='+str(x) for x in product_ids])
    cursor.execute("select hashcode,group_concat(product_id) from tb_matching  where {} group by hashcode".format(sql))
    hashcode_dict = dict(cursor.fetchall())
    for product_id in product_ids:
        cursor.execute("select hashcode  from tb_matching where product_id ={}".format(product_id))
        product_select = cursor.fetchall()
        hashcodes = [x[0] for x in product_select]
        group = [hashcode_dict[x].split(',') for x in hashcodes]
        group = _flatten(group)
        product_id = Counter(group)
        stop = 0

def check():
    origial = [577687236217,577855025900,578095423544,577683972542,577853033105,577683268315,577975262441,578092679983,577850853078,577680896866,577849477567,578090655004,577971662946,577679140284,577970854264,577970726248,577677356393,577845153579,577844445543,577844341598,577967946156,578084367616,577672392853,578082491954,577963434209,577962430367,578077683796,577835737336,578076579970,578076955448,577834605428,577834401342,577664664820,577833169724,577832653702,577955978650,577816597151,577816053841,577816017864,577939502597,577937350230,577937358154,577645288347,577937346070,577641824616,577933950370,577934118116,577641668758,577641848404,577810021675,577641200238,577640908686,577640748751,577933234129,578050591652,577932706938,577640484996,577640844524,578050575520,577932886441,578001434911,578108349783,578351003091,578107517861,578230054791,578349195855,578349251182,578106613126,578347795765,578227466238,578226686134,578103577263,578225766090,578345471526,578345031458,578224642750,577931260701,578099649682,577928608220,577927676246,577927456385,578340279252,578094633019,577923460809,577922504685,578335239977,577922192374,578092901401,578092933309,578215078113,577921184062,577920172123,577898932525,578192702192,578069297581,578069545159,577898752779,577898720706,577898888414,578312059141,578192406546,577899080019,577898880324,577898676766,578311715806,577898916327,577898660711,578311979156,578068957810,578192178828,578311847429,578312031004,578069053700,578069433098,578192422317,578068857916,578068933744,578069121442,577898764130,578068725838,578069057425,577898488545,577898456561,578292987066,577879560184,578172306040,577875412937,577875188846,577875428191,578044305802,578167990397,578286955653,578043697679,578166886299,577873136548,578166186337,578284959126,578041509991,578041273911,578164262875,577871116262,578163090073,578039297307,578281543581,578038669246,578038437299,578038057200,578160770921,578159362312,578158158329,578156962711,578138526154,578138230662,578256243927,578256463454,578013589398,578137054896,577844164184,578013305887,578137326322,578256371456,578013405532,578256087912,578256195631,578256247487,577843824661,577844096029,578256035983,577843644930,578256371166,578013085970,578256131603,578013121818,578137186113,577843672778,578256327145,578227975137,578108186738,577983501332,577814064408,577982933389,578106178801,578224703612,578224779101,578223731288,578104970494,578104506905,577811356367,578104102126,578222687022,578221907234,577977249747,577807388971,577807592003,577976433725,578099102368,577975253425,578216779651,577974001347,578216539156,578215427965,578215803184,577973033618,577802804375,577950913324,577950897339,577781624845,577781952012,578193715665,578074990968,577950633614,577781612643,577781436908,578075254377,577950333902,577781320963,578193471931,577950465637,577781268930,577950649232,578075202138,577781408628,578193691265,578193503633,577950313647,577781204884,577781556261,578074670997,578193623341,578075126097,578193395663,577950277539,578074866372,578193603094,577754212569,577922933859,578164783138,578164279651,578163343731,578161927775,577749812798,577918713702,578160963475,577918217772,577917769027,577917273098,578158655537,577746904169,578039454315,577915113757,577744192854,578155323561,577743176907,578034462558,577910653051,578150623457,578031906016,577737588965,577906433582,578029018726,577904365156,577732612668,578144195713,577713808253,578124691358,578124667336,577713664270,577882145843,578006498132,577713544484,577882093856,578006494035,578006034986,578006350279,578006022963,577712652605,577881689338,578005654369,577712572619,578005386759,578124011108,577712424761,577881433711,578123779562,577712416770,578005658125,578005166913,577910854167,577786029490,577786033754,577908462642,578025735273,578025119876,578024643252,577783397011,578022739831,577782277780,578022563633,577780333965,577780641506,578021383220,578017235078,578015407374,577605652538,577604484414,577603572612,577603108781,578011939128,577889478531,578004947908,577883914833,577760425190,577759609774,577998483322,577856474012,577855582853,577972331978,577563996984,577733033140,577855586765,577564588445,577972867468,577732421627,577733073107,577855898578,577972471752,577732993157,577564664129,577702013715,577939839414,577530416037,577529504411,577819942539,577935883091,577818394724,577815998376,577523820841,577523632683,577813730698,577929939527,577689313001,577520188496,577687745061,577683377073,577805862415,577681309988,577680013814,577919663127,577490048003,577656105737,577895111973,577489060657,577656073947,577894995953,577779150057,577778318883,577778298572,577655869733,577778922149,577778246564,577895207326,577895043357,577655853873,577868015751,577628129629,577747478066,577863171517,577746750231,577745434612,577622105478,577743614587,577743802069,577619629747,577619017501,577740526668,577617925209,577450548447,577615373879,577614049016,577612289165,577442732902,577845995264,577845183905,577705378203,577583573364,577417412445,577417636171,577821807614,577705410009,577705090218,577822455063,577582537708,577704354390,577416404744,577583049301,577581701980,577583181089,578069960789,578244005959,578367086180,578486983664,578242829674,578486063228,578364710880,578484715599,578364258138,578066664417,578483143692,578464555529,578464731041,578343438158,578343350324,578047024470,578343138585,578464559053,578220601986,578342794949,578220761608,578220761536,578342798738,578046848285,578046964054,578046648435,578464215161,578464219123,578343054138,578046328838,578046820077,578220505720,578342838379,578220325952,578463727880,578046256829,578463823530,578312486697,578311666765,578076876933,578373658356,578076260666,578250337405,578372022130,578248397757,578492003285,578370262004,578432159532,578187953818,578012608250,578184277743,578305090956,578426399656,578010952146,578182349558,578181977821,578424123365,578302726205,578301214286,578422011360,578178361485,578177685618,578419847611,578004204694,578418619191,578174821823,578002752212,578173933590,578173273196,578171541040,578170233362,578169565723,578412235289,577997856003,578168929261,578290418700,578411075440,578407895301,578407827605,577993252493,577993184757,578165021433,578286786339,577972756174,578144633017,578265790909,578386683976,578386791620,578144525259,578143825656,578143581950,578265266888,578143729914,577972028787,578265702026,578143573801,578386443117,578143905227,578143597997,578143677743,577971780603,577971956308,578385883886,578265510032,578265502002,578386255349,577971424934,577971764615,578143413581,577971924072,577971564812,578084800150,578258425536,578380866391,578082684660,578500235650,578500311088,578379398570,578081204268,578254933037,578498455019,578079740259,578253157715,578496807407,578375982666,578078508064,578495507147,578265901603,578387842232,578386590854,578088656009,578087976877,578262725626,578505703679,578261605959,578383458374,578503783550,578085296546,578268317369,578093088527,578267753576,578415510012,578413290733,578115956393,578535235421,578291209303,578115780814,578291189344,578291277104,578535315096,578534959948,578291145279,578534923962,578116020057,578291081360,578291037447,578290865780,578115852331,578115748495,578534991598,578290913507,578413294186,578115624634,578290801795,578535095189,578115416895,578534947509,578115576628,578412890893,578319601951,578317777273,578317457507,578317233367,578316117458,578316089515,578437882005,578314989746,578558871316,578139328456,578313613660,578313765241,578449574572,578152336353,578327573156,578151272104,578569019488,578324517036,578445490697,578147400443,578322521657,578443198370,578336213959,578456782864,578455794888,578158744266,578574635517,578574279511,578451646162,578153868040,578162000570,578608907748,578607915286,578187160867,578484890164,578607563834,578607699606,578484894026,578363277556,578362937973,578607379937,578607547566,578363049712,578363381088,578187220155,578607531415,578186832779,578186984505,578363213290,578187080314,578607303528,578363061441,578187176107,578362917597,578484394505,578607411405,578607555148,578607339430,578484222837,578213812441,578389081297,578510310595,578217936959,578394101780,578393565702,578393261515,578391181867,578635363826,578405317110,578649227203,578524830722,578524670341,578645327790,578522578140,578398877513,578397821726,578518374171,578220288082,578517706070,578639611123,578218624614,578560506230,578438857645,578262036431,578560150947,578682975476,578261752927,578261924358,578559998782,578261708727,578438429828,578261660757,578682755480,578559838780,578682559772,578682687462,578438577265,578559910478,578438301649,578559730797,578261636363,578682703082,578438097710,578682623137,578438369135,578261288963,578559842161,578262128868,578683163795,578262216594,578262204503,578560350831,578261996845,578262344046,578438853765,578438737910,578291860037,578589634651,578711383590,578587862566,578295624048,578294756248,578471513166,578714203084,578469573007,578599578903,578721475447,578598342074,578475913273,578297352435,578296884061,578717883695,578604506518,578304972113,578603350925,578303880165,578602666054,578325524982,578503313562,578503261659,578503081903,578326008412,578748419191,578326144073,578748231468,578326004267,578748211509,578748003906,578748067685,578325800484,578624874825,578524237623,578646038056,578345952343,578768259521,578345584906,578645046192,578522693673,578767423475,578344468378,578774927163,578651838498,578351824494,578351844204,578529377313,578773483230,578528409345,578771679627,578647114425,578646794108,578654850652,578777231219,578532713039,578354464906,578532385123,578653746309,578531613100,578778231967,578361376206,578784123774,578360708309,578538781835,578660378346,578360464145,578538089461,578659190924,578542137468,578541545128,578662522094,578380524036,578380368802,578803431966,578558909620,578803415509,578803423286,578803275857,578380332187,578803375050,578803335200,578380276150,578380268071,578380172643,578380232014,578558009773,578679530956,578679622213,578820655063,578397128138,578396464946,578819443227,578819127069,578696614253,578401108125,578400724313,578400548484,578398724970,578577121466,578821243084,578821039893,578827383490,578827131033,578703910575,578825123884,578580025783,578702662454,578585625595,578830563240,578406260753,578707254812,578706774105,578828547034,578705626837,578827759806,578404060676,578705246340,578409924103,578588161897,578710206073,578832451261,578587461503,578407724101,578835487651,578834303446,578594333155,578593089435,578838199254,578414032957,578611073041,578610805922,578732906668,578610873661,578610837252,578610857100,578855779274,578610837108,578733614019,578733522240,578733498147,578856315525,578856271524,578432500477,578856171649,578856143066,578733114397,578633033301,578878175654,578877607228,578875539536,578451328425,578751858920,578629397057,578751302464,578874079793,578449532124,578627817875,578459824208,578459560780,578760310641,578883315813,578459048462,578637081576,578636873382,578882615273,578882487511,578636357322,578457896491,578457252739,578757862276,578881227300,578456928351,578456540268,578455336903,578633237576,578639981815,578885551625,578639241589,578761398844,578460248612,578761074363,578486876496,578788426323,578911571222,578911571173,578665489397,578486844526,578911479469,578486796650,578486712967,578486844307,578788378141,578665321898,578665377422,578911455154,578788262601,578486668567,578788258128,578911331283,578788198319,578486576413,578911167884,578486488424,578787970786,578665097766,578788042258,578787998350,578911039904,578486292920,578787802947,578911063273,578510704035,578509312766,578810458172,578931547472,578505392462,578684177734,578929227470,578503792263,578694349627,578694013327,578693473553,578511900023,578946543544,578822454018,578822378172,578945559294,578518552481,578517128934,578696877231,578696701640,578696097510,578515560199,578941303808,578817242827,578524276516,578524152943,578702921330,578825970197,578522252344,578522200292,578948015468,578947547783,578844774040,578844758009,578542596051,578722009394,578542892570,578968791038,578844914991,578844970722,578968631262,578542848312,578542776574,578542740362,578542752294,578844714779,578721561889,578844690917,578542616169,578542660010,578721585610,578741065742,578864098154,578987111137,578740185936,578561004877,578986063386,578862278044,578865022142,578994151325,578747073320,578870198524,578869522511,578992711407,578992155987,578744645970,578563808304,578563576118,578988615292,578874454245,578572184132,578873854740,578997071913,578996823204,578749641631,578872626150,578996019088,578995571171,578871574506,578994879484,578877826617,578877410348,578876294428,578876166094,578573200885,579002347356,578878574575,578779353695,578600100274,578902830899,578903010864,579026523940,579026587846,579026655420,578903094182,578779441743,578600128675,578779413784,579026483975,578902962501,579026439790,578902842939,578927458295,578802025444,579048695601,578621344491,578621336407,578800957080,578923278802,579046743350,578620048007,579045971423,579045615551,578807969782,578931094925,578807581581,578627636492,579053259857,579052791720,578625860359,578928410768,578810957745,578810469712,578933606474,578933202299,579056571068,578932134685,579055239017,578628720148,579060675599,578935982496,578632516319,578935458274,578811573827,578934794598,578941150528,579064231393,578939834107,578816177100,578939150315,578635704126,578944230178,579067299626,578943658185,579066627548,578644392466,579068503317,578965030668,578841677340,578661852497,578964970582,578841613107,578661716776,578964910503,578661744145,579087751934,578841473374,578964734871,578841381662,578964722463,579087759022,579087523886,578964518695,578841057912,578964526287,578661276536,579087447408,579087419449,578841069294,578661260122,579087335684,579087383160,579087335159,578840805966,578964254632,579087171909,578660920989,578660908897,578840829018,578660976321,578840745135,579087107479,578862173367,578985638786,579107747100,578984646308,578860529805,579116531093,578689624834,579115207604,578688004466,578866909420,578686876748,578683940894,578863741088,578683616774,578986978182,579109403875,578682884670,578873005169,578692976447,578872353623,578995334456,578995262732,578994882652,578870909247,579117055848,579123139852,579123067363,579122755766,578875197810,578998890024,578998438392,578874153187,579126783297,578699372758,578698824466,579002174632,579124967101,578697508572,578883057736,579129459230,579129015350,579128195319,578700848483,579004666074,579010846816,579010586082,578704768674,579130967878,578903653904,578903657749,578903621989,578723696023,579150511423,579150439444,579028134274,579028138228,579028026779,578903401605,578723340844,578723376410,579150367135,579150259909,579027806999,579027930276,579150103988,579027822631,578723180510,578903161437,579150067416,579150171462,578723200564,579050658427,578750124741,578748136890,578927309673,579059538686,579056618032,579178423245,579186099081,578938137269,579061962479,578936769801,578756328542,578936049109,578947837822,579071474947,579071070274,578766356236,579193483622,579191635183,578943681269,579067914396,579189635827,579066570136,578941429812,578940897953,578760656673,578760644126,579187163215,578951529434,579198723209,578949389122,579073294959,578777476488,579081518319,578975541988,578975545518,579222083757,579098686281,579098582610,579221759518,578975241148,578794708340,579221619690,579221719105,579221647472,579098386946,579221643387,579221615539,579098434498,578794568961,579098442321,578794552585,578820444282,579123778016,578999269121,578824688469,579252239854,579252287490,579250671510,579001701057,578821296105,579255779318,579254587101,579253851001,579253079024,579005985110,579260127465,578832596481,579012813987,579135958273,579258703210,579011565410,579134954605,579134598908,579257907487,579010797835,578829704244,579009661670,579133082965,579141214448,578835776846,579015765241,579139038274,579262007723,578833612346,578833604238,578833028335,578843992102,579270747936,579021989297,579145402768,578840188714,578840224127,579020501074,579020345351,579274639701,579049729012,579173726298,579173566998,579049641329,579296971474,578869080655,579049537889,579296991217,579173526837,579049485620,578869116246,579173546756,579173542655,579296879642,579049365879,579049369905,579173422743,579173494142,579173486062,579077745437,579323319365,579074933430,579073857837,579198878051,579320991521,579320479185,579072121998,579071621416,578901928125,579204406561,579079093701,578898652265,578915984880,579221510742,578912688904,578912172948,578911724821,578910748742,579091113177,579213726283,578907464483,578907168174,578906984503,579087597630,579087065829,579334175591,579086093896,578904472453,579332263832,578903048898,578902948107,579207822693,579027015268,578779749363,578600360833,579026815735,578600456181,578779609938,578779609775,578779681045,578779581844,578779525757,579049853038,578869328302,579173818588,579049629816,579049601988,579049685689,579297063328,579173706463,579297003502,579420091394,579169005427,579166841617,579164229726,579410003610,579408823196,579285650640,579160045761,579159853163,579158877612,579158921261,579406299617,578976448695,579157337669,579281870827,578973836088,578973340271,579279390995,578972820024,579278474226,579400323063,578970332496,579274854467,578967192054,579272746852,579272594453,578965028100,578964956109,579270974276,579145877308,578943636065,578943032347,579248682956,579371427819,579248658532,578942920374,578942936271,578942808766,579248490494,579371175355,579123437987,578942656095,579248262652,579123561071,579364139796,579364123090,579241246454,579116825023,579116701868,579116697293,579116433874,578935352144,578935212202,578935088663,578935052941,579422943059,578993464138,579299354152,579015840390,579197997723,579015664908,579323958860,579324018052,579198765262,579445979822,579323962068,579445923753,579323830536,579016432029,579445767208,579198513197,579016220264,579016184276,579323502742,579323490729,579445631143,579445479891,579198217703,579323370696,579198149848,579445431531,579015828857,579198081884,579445359569,579198133330,579445223956,579040796516,579468943829,579469103123,579346650092,579038968740,579037788684,579234269735,579051776464,579050896452,579050408117,579049416705,579048912675,579224613625,579042500444,579042356626,579349390213,579349142364,579470915085,579348394740,579372970561,579064184830,579371270490,579244845097,579061708518,579368754392,579365566955,579240369596,579487007335,579364090371,579237269612,579236737823,579236321335,579054312553,579235685218,579543295655,579295505899,579542515148,579294277338,579417882678,579397674800,579396910287,579088472416,579518699281,579271201807,579396338691,579518583051,579271025089,579088152152,579395990899,579270993033,579270921241,579270893310,579518251419,579270789770,579270789640,579088028277,579307237015,579553631961,579120020862,579549995825,579302045267,579547647597,579309493719,579307581763,579315413332,579437474476,579312997947,579565379728,579563671837,579783279558,579534057851,579351108963,579659018094,579782411348,579658774215,579658546410,579533313843,579658298222,579658162610,579350476658,579781331571,579522821318,579335536922,579642042923,579517917740,579334856619,579517405659,579763675540,579635742449,579384317672,579507730825,579626007914,579194932575,579194268620,579623175444,579621719652,579499094865,579498246709,579189704326,579373565072,579619367572,579371533166,579186704562,579369613786,579368989021,579367237426,579488206747,579362825987,579178112503,579177704073,579607991323,579587463737,579340633298,579464494624,579156108394,579156064335,579156052241,579155856542,579340381316,579155784487,579586919987,579155800263,579587043088,579340213260,579464210405,579340149353,579464094594,579586823206,579375496663,579804267717,579376944004,579684718996,579559073974,579558901987,579567373781,579384280873,579383936885,579565613547,579690914628,579711450127,579584493884,579834051621,579401312324,579709926001,579583341100,579832139092,579582257026,579399184914,579707062708,579830779248,579704950003,579827727189,579394860005,579826411553,579394032795,579702578210,579393464106,579701498891,579700370532,579391708502,579699578522,579573597333,579822979574,579820963463,579696358888,579387648684,579819263859,579694882175,579818675595,579817827786,579408336417,579589709801,579588305384,579669069727,579667113464,579916551508,579666341154,579915759432,579914699797,579911435203,579785218321,579784706534,579784602682,579475472628,579783498780,579473696587,579472600520,579655165959,579781266374,579653681106,579469184696,579468188068,579900671190,579649377535,579898279487,579773910701,579773870384,579646829447,579772330393,579767122976,579765902862,579765514177,579889175961,579761426748,579635481449,579430000757,579611777511,579611749682,579611685983,579428728904,579737506757,579611565596,579428580650,579611561248,579737422390,579611433884,579737398018,579428444352,579428432171,579861459968,579428396137,579861559078,579737098268,579736990903,579861315593,579861227573,579861255017,579610837915,579428060060,579736678468,579826011000,579516704239,579949215659,579949223291,579699417649,579516612380,579826046087,579699465110,579699385573,579947291524,579697489443,579514628809,579823938150,579947267072,579823918149,579823850618,579823758914,579823826317,579514476727,579514416942,579823790094,579947091324,579823766144,579730085003,579979299570,579728937440,579979263283,579728557512,579732085965,579731957513,579981603533,579981171877,579554660755,579560156727,579992751331,579869594225,579869486834,579992571814,579558972763,579741073863,579740849585,579558268556,579997047968,579872490026,579744153828,579994931842,579561024367,579870774825,579751545909,579749905775,579877326618,579999675639,579565820820,579999139577,579875834398,579998651562,580006131906,579882082345,579881994046,579753893930,580004487969,579879830428,579879550390,579886178030,579576060361,579572920215,579883142194,579888950940,579577888156,579886782022,580023143579,579902502964,579900918277,579776609651,579779181195,579779089498,579778989947,579779077313,579596712025,579778865956,580030523417,579596536553,580030403663,579778677934,580030371499,579778545915,579596332634,579778689218,579596352226,580030275040,579905850356,579595256037,579596900216,580030843672,579779201889,579596760739,579779245394,579596828040,579779165567,580064231325,580063435368,579810377818,580062299237,579809993193,579636416651,579815109660,579632528724,579814329090,579813317315,579953458302,580078379789,579643068951,579950710559,579948230974,579833049438,579832621353,579956614300,579955966175,580080431243,579954762526,579954810295,579992994594,579860849726,579676720233,579668540620,579847933456,579975178518,579664496323,579663636724,579973050347,579844617248,579971814565,580096723352,579838597914,579965462296,579654964811,579964402031,579963046895,579962230457,579651272711,579724708929,579908053824,580161115844,579907989831,579724780046,580161079619,579724712109,580034966861,579907821531,579907777555,579907681907,579724484402,579907781158,580160827337,580160631836,580034658639,579724172517,580160627237,580160499539,580160571133,579724044376,579907369039,580160451069,579907185374,580160395007,579777192034,579773752363,580085270334,579772528724,579772168927,579772048327,580083518057,580104842502,579792856490,580229671067,579791968061,580103706301,579790924523,579974113685,579789264835,580100278362,580217959439,579964421083,579779068141,579989265233,580115322276,580241291704,580240659029,580112170342,580237463245,579984405597,579799068258,580236355299,580235727146,579982045618,580233563352,580233375181,579795848267,580107486890,579814388088,579994805543,580119786444,579992037807,579805708026,579805472648,579805224961,579804988874,580274987597,580274979500,579837420844,579837344985,579837404556,580148546533,580274911262,579837300967,580148478490,580148430773,580021905525,579837320392,579837260396,580274779354,580021861383,579837092892,579837012950,579837072919,580274659617,580021773115,580274687011,580021701077,579863456284,580047429985,580299779941,580172742003,580305511815,580052665892,580304515256,580175806030,579864108617,579871504571,580307783721,579869584876,580053725308,580192026836,580065609763,580065397066,580317927186,580064897990,579879232280,580315735030,580187942920,579875928814,580312759534,580312787306,580059717726,580185390630,579874196722,579873648865,579885292536,580070185474,580195526283,580068593669,580320623544,580068045493,580320603180,580320019878,579882048617,580204714163,580199598485,580188142767,580071169613,579887452248,579882832567,580220298187,580094125112,579909576273,579908192907,579907672963,579906384670,579917108580,580355319746,579917120197,580101965985,580102005820,580354935415,579916644291,580227366307,579916008754,580227258866,580384763659,579946756030,580381255007,580380995832,580253202632,579941412835,579941044115,580379019435,580378511924,580135209656,580386679955,580259418038,579947428590,580385163948,580140529873,579954536699,579953964241,580265138510,580391119515,580139113592,580138849406,580390223191,580138185265,579951984358,580137233003,580146269180,580271334777,580396467702,580144581549,579958044979,579957272744,580268482242,580268334619,580142397600,580267502564,579955368374,580405339554,580404583578,580277758147,580151397996,580151253094,580403299894,580276090912,579964132040,580275498551,579963160729,580400235425,579962324274,580147745697,580147729694,580273030220,580272318612]
    selected = [577692000305,578677944652,578685252450,578687528582,578694732869,578701700138,578711868562,578839220054,578839332873,578841944462,578844188644,578845872826,578852456665,578854044763,578858704746,578864384899,578864404812,578871157099,578878057304,578882361059,578897537047,578908656165,578917632308,578924864350,578925904502,578930968926,578962313677,578964000190,578964844758,578986812746,578987764472,578987772099,578990680955,578991852646,578998934664,579003068170,579006508759,579009502144,579010232424,579011121818,579012089936,579012594962,579015793796,579016321903,579017682463,579020034338,579020945345,579026477272,579038105094,579040288537,579042944439,579043365863,579044453895,579045357367,579057188432,579059280146,579062600070,579073560581,579079084357,579079728725,579080084495,579080264865,579084680222,579098177648,579108665184,579113085387,579113477027,579113848321,579114913040,579121024934,579123399154,579124542365,579130499434,579135110276,579135502744,579136318705,579137402720,579142042161,579142413790,579146182250,579146438526,579146726978,579157958231,579162950328,579164486610,579164957525,579166333233,579167425040,579170054870,579174325276,579174420029,579182668407,579187540993,579191149073,579191713613,579197252214,579198116008,579199427996,579200876144,579210544302,579220073061,579220222669,579231438188,579232926829,579234814080,579239574605,579240145913,579243065356,579243221071,579243607519,579244499968,579244637472,579245609821,579246544998,579246953709,579247559069,579248267801,579248515279,579255815473,579258751145,579259116925,579262399043,579264911960,579270867502,579283639645,579283703168,579284534999,579287187271,579290719064,579293798898,579294854085,579296306512,579303749600,579313725833,579317386009,579317674187,579318525853,579319711576,579333265468,579345278635,579357809313,579361946277,579363703276,579366958175,579369118242,579374334530,579375238521,579378637587,579382726785,579383352473,579392979839,579407901663,579408967399,579411795959,579417531914]
    sdf = len(origial)
    da = len(selected)

    stop = 0
db, cursor = mysql_config()
if __name__ == '__main__':
    # data_split()
    # data_merge()
    # fill_shop_id()
    # show_pic_link()
    # val_matching()
    check()


